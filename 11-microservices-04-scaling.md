
# Домашнее задание к занятию «Микросервисы: масштабирование». Наталия Ханова. 

Вы работаете в крупной компании, которая строит систему на основе микросервисной архитектуры.
Вам как DevOps-специалисту необходимо выдвинуть предложение по организации инфраструктуры для разработки и эксплуатации.

## Задача 1: Кластеризация

Предложите решение для обеспечения развёртывания, запуска и управления приложениями.
Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:
- поддержка контейнеров;
- обеспечивать обнаружение сервисов и маршрутизацию запросов;
- обеспечивать возможность горизонтального масштабирования;
- обеспечивать возможность автоматического масштабирования;
- обеспечивать явное разделение ресурсов, доступных извне и внутри системы;
- обеспечивать возможность конфигурировать приложения с помощью переменных среды, в том числе с возможностью безопасного хранения чувствительных данных таких как пароли, ключи доступа, ключи шифрования и т.п.

Обоснуйте свой выбор.

Подходящим решением для указанных требований является **Kubernetes (K8s)** — открытое ПО, предназначенное для автоматизации развертывания, масштабирования и управления контейнеризированными приложениями.

Kubernetes обеспечивает обнаружение сервисов и маршрутизацию запросов. При создании сервиса ему присваивается DNS-имя, которое разрешается в IP-адрес с помощью компонентов **kube-dns** или **CoreDNS**. Приложения внутри кластера могут обращаться к сервисам по имени, а маршрутизация трафика между ними осуществляется через iptables или IPVS. Для обработки входящих HTTP/HTTPS-запросов извне используется **Ingress-контроллер**, позволяющий направлять трафик к нужным сервисам по хосту или пути.

В Kubernetes поддерживается **Horizontal Pod Autoscaler (HPA)** — встроенный механизм, автоматически масштабирующий количество подов в зависимости от нагрузки (по CPU, памяти и другим метрикам). Его использование повышает отказоустойчивость системы и позволяет экономить ресурсы, когда нагрузка невысока.

Помимо HPA, может быть настроен **Kubernetes Event-driven Autoscaling (KEDA)** — расширение, позволяющее масштабировать поды на основе внешних событий. Для его работы требуется установка контроллера KEDA, но это делает систему более гибкой и устойчивой к пиковым нагрузкам. Также остаётся возможность ручного масштабирования подов и реплик.

Разделение внутреннего и внешнего трафика — базовая архитектурная практика в Kubernetes. Для внутреннего трафика используется **ClusterIP** — сервисы доступны только внутри кластера.

Для внешнего доступа применяются:
* NodePort — открывает фиксированный порт на всех нодах (подходит для отладки, но ограничен по масштабируемости);
* LoadBalancer — создаёт внешний IP-адрес через облачный провайдер (удобно, но каждый сервис требует отдельного IP);
* Ingress — «интеллектуальный маршрутизатор», позволяющий направлять трафик с одного IP к разным сервисам по правилам (хост, путь, субдомен).

Для конфигурации приложений в Kubernetes используются:
* ConfigMap — для хранения неконфиденциальных параметров: адресов сервисов, логики работы, настроек окружения;
* Secret — для хранения чувствительной информации: паролей, токенов, ключей доступа. Доступ к секретам может быть ограничен с помощью RBAC (Role-Based Access Control).

Дополнительно можно включить шифрование секретов на уровне **etcd** — встроенного распределённого хранилища состояния кластера. Также Kubernetes может быть настроен на использование внешних KMS-провайдеров, таких как **HashiCorp Vault**, для хранения ключей шифрования.

## Задача 2: Распределённый кеш * (необязательная)

Разработчикам вашей компании понадобился распределённый кеш для организации хранения временной информации по сессиям пользователей.
Вам необходимо построить Redis Cluster, состоящий из трёх шард с тремя репликами.

### Схема:

![11-04-01](https://user-images.githubusercontent.com/1122523/114282923-9b16f900-9a4f-11eb-80aa-61ed09725760.png)

---

### Как оформить ДЗ?

Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.

---
